<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Favicons -->
    <link rel="apple-touch-icon" src="/img/blockchain.png" sizes="180x180">
    <link rel="icon" src="/img/blockchain.png" sizes="32x32" type="image/png">
    <link rel="icon" src="/img/blockchain.png" sizes="16x16" type="image/png">
    <link rel="manifest" href="https://getbootstrap.com/docs/4.4/assets/img/favicons/manifest.json">
    <link rel="mask-icon" href="https://getbootstrap.com/docs/4.4/assets/img/favicons/safari-pinned-tab.svg"
        color="#563d7c">
    <link rel="icon" href="/img/blockchain.ico">

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/offcanvas.css">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/offcanvas.js"></script>
    <title>RealEstateTransaction</title>
</head>

<body>
    <section id="nav"></section>
    <section id="nav_second"></section>

    <main role="main" class="container">
        <hr>
        <h2>부동산 상세 정보</h2>
        <table class="table table-striped">
            <tbody>
                <tr>
                    <th scope="row">Title : </th>
                    <td><%=title%></td>
                </tr>
                <tr>
                    <th scope="row">Seller : </th>
                    <td><%=seller%></td>
                </tr>
                <tr>
                    <th scope="row">Price : </th>
                    <%
                        if (cointType == 1) {
                    %>
                    <td><%=price%> BIT</td>
                    <%                            
                        }else{
                    %>
                    <td><%=price%> ETH</td>
                    <%
                    }
                    %>
                </tr>
                <tr>
                    <th scope="row">Address : </th>
                    <td>
                        <div id="map" style="width:100%;height:350px;"></div>
                    </td>
                </tr>
                <tr>
                    <th scope="row">Timestamp : </th>
                    <td id="timestamp"><%=timestamp%></td>
                </tr>
                <tr>
                    <th scope="row">Status : </th>
                    <td id="status"><%=status%></td>
                </tr>
            </tbody>
        </table>
    </main>
    <input type="hidden" name="mb_id_session" id="mb_id_session" value="<%=mb_id%>">
    <input type="hidden" name="locationAddress" id="locationAddress" value="<%=locationAddress%>">
</body>
<script>

</script>
<script src="/js/nav.js"></script>
<script src="/js/nav_second.js"></script>
<script type="text/javascript"
    src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c00ea0bf28cce3c71be998107d5a7f76&libraries=services">
</script>
<script>
    $(() => {
        document.getElementById('timestamp').innerText = getTimestampToDate(document.getElementById('timestamp').innerText);
        //var status = document.getElementById('status').innerText;
        var locationAddress = document.getElementById('locationAddress').value;
        // switch (status) {
        //     case '0':
        //         document.getElementById('status').innerText = '판매중';
        //         break;
        //     case '1':
        //         document.getElementById('status').innerText = '거래완료';
        //         break;
        //     case '2':
        //         document.getElementById('status').innerText = '판매중지';
        //         break;

        //     default:
        //         break;
        // }

        var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
            mapOption = {
                center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                level: 3 // 지도의 확대 레벨
            };

        // 지도를 생성합니다    
        var map = new kakao.maps.Map(mapContainer, mapOption);

        // 주소-좌표 변환 객체를 생성합니다
        var geocoder = new kakao.maps.services.Geocoder();

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(locationAddress, function (result, status) {

            // 정상적으로 검색이 완료됐으면 
            if (status === kakao.maps.services.Status.OK) {

                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                // 결과값으로 받은 위치를 마커로 표시합니다
                var marker = new kakao.maps.Marker({
                    map: map,
                    position: coords
                });

                // 인포윈도우로 장소에 대한 설명을 표시합니다
                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div style="width:150px;text-align:center;padding:6px 0;"><h5>매물 위치</h5></div>'
                });
                infowindow.open(map, marker);

                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                map.setCenter(coords);
            }
        });
    })

    function getTimestampToDate(timestamp) {
        var date = new Date(timestamp * 1000);
        var chgTimestamp = date.getFullYear().toString() + '-' +
            +addZero(date.getMonth() + 1) + '-' +
            addZero(date.getDate().toString()) + ' ' +
            addZero(date.getHours().toString()) + ':' +
            addZero(date.getMinutes().toString()) + ':' +
            addZero(date.getSeconds().toString());
        return chgTimestamp;
    }

    function addZero(data) {
        return (data < 10) ? "0" + data : data;
    }
</script>

</html>